(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-01115450"],{1739:function(e,t,r){},"19cf":function(e,t,r){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"col-lg-12"},[t("div",{staticClass:"level"},[t("div",{staticClass:"level-left"},[t("ul",[t("li",{staticClass:"is-active"},[t("a",[e._v(e._s(e.breadcrumbs.b1))])]),t("li",{staticClass:"is-active"},[t("a",[e._v(e._s(e.breadcrumbs.title))])])])])])])},s=[],a={name:"breadcrumb",props:["breadcrumbs"]},n=a,o=(r("2c06"),r("2877")),l=Object(o["a"])(n,i,s,!1,null,"7cf2419e",null);t["a"]=l.exports},"1da8":function(e,t,r){e.exports=r.p+"img/bus_marker_red.7a4bd012.png"},"2c06":function(e,t,r){"use strict";r("526f")},"4b25":function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e._self._c;return t("section",{staticClass:"dashboard"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-lg-12"},[t("Breadcrumb",{attrs:{breadcrumbs:e.breadcrumbs}})],1)]),t("b-card",[t("b-card-text",[t("b-row",[t("b-col",{attrs:{cols:"12"}},[t("div",{staticClass:"py-2 align-end"},[t("b-button-group",{attrs:{size:"md"}},[t("b-button",{attrs:{variant:"outline-success",pressed:e.onlinepressed},on:{click:function(t){return e.fetchMapData("ONLINE")}}},[e._v("Online Driver")]),t("b-button",{attrs:{variant:"outline-primary",pressed:e.trackpressed},on:{click:function(t){return e.fetchMapData("TRACK")}}},[e._v("Track Driver")]),t("b-button",{attrs:{variant:"outline-danger",pressed:e.offlinepressed},on:{click:function(t){return e.fetchMapData("OFFLINE")}}},[e._v("Offline Driver")])],1)],1)]),t("b-col",{attrs:{cols:"3"}},[t("div",{staticClass:"py-2"},[t("b-overlay",{attrs:{show:e.loading,rounded:"sm",variant:"black"},scopedSlots:e._u([{key:"overlay",fn:function(){return[t("div",{staticClass:"text-center"},[t("p",{attrs:{id:"cancel-label"}},[e._v("loading drivers...")])])]},proxy:!0}])},[t("b-input-group",{staticClass:"mb-1",attrs:{size:"sm"}},[t("b-input-group-prepend",{attrs:{"is-text":""}},[t("i",{staticClass:"menu-icon typcn typcn-zoom"})]),t("b-form-input",{attrs:{placeholder:"Search name or mobile number"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),t("div",{staticStyle:{position:"relative",height:"600px","overflow-y":"auto"}},[t("b-list-group",e._l(e.markers,(function(r,i){return t("b-list-group-item",{key:i,staticClass:"d-flex align-items-center justify-content-between"},[t("b-img",{staticClass:"mr-2",attrs:{thumbnail:"",rounded:"circle",fluid:"",width:"50",alt:r.short_name,src:r.picture}}),e._v(" "+e._s(r.fullname)+" - "+e._s(r.phone)+" ")],1)})),1)],1)],1)],1)]),t("b-col",{attrs:{cols:"9"}},[t("MapView",{attrs:{center:e.center,markers:e.markers}})],1)],1)],1)],1)],1)},s=[],a=r("2b0e"),n=r("dde5"),o=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[t("div",{ref:"mapDiv",staticStyle:{width:"100%",height:"80vh"}})])},l=[];r("0643"),r("4e3e");function c(e,t,r,i){function s(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,a){function n(e){try{l(i.next(e))}catch(t){a(t)}}function o(e){try{l(i["throw"](e))}catch(t){a(t)}}function l(e){e.done?r(e.value):s(e.value).then(n,o)}l((i=i.apply(e,t||[])).next())}))}function u(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}"function"===typeof SuppressedError&&SuppressedError;var h=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var i,s,a;if(Array.isArray(t)){if(i=t.length,i!=r.length)return!1;for(s=i;0!==s--;)if(!e(t[s],r[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(a=Object.keys(t),i=a.length,i!==Object.keys(r).length)return!1;for(s=i;0!==s--;)if(!Object.prototype.hasOwnProperty.call(r,a[s]))return!1;for(s=i;0!==s--;){var n=a[s];if(!e(t[n],r[n]))return!1}return!0}return t!==t&&r!==r},d=u(h);const p="__googleMapsScriptId";var b;(function(e){e[e["INITIALIZED"]=0]="INITIALIZED",e[e["LOADING"]=1]="LOADING",e[e["SUCCESS"]=2]="SUCCESS",e[e["FAILURE"]=3]="FAILURE"})(b||(b={}));class f{constructor({apiKey:e,authReferrerPolicy:t,channel:r,client:i,id:s=p,language:a,libraries:n=[],mapIds:o,nonce:l,region:c,retries:u=3,url:h="https://maps.googleapis.com/maps/api/js",version:b}){if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=e,this.authReferrerPolicy=t,this.channel=r,this.client=i,this.id=s||p,this.language=a,this.libraries=n,this.mapIds=o,this.nonce=l,this.region=c,this.retries=u,this.url=h,this.version=b,f.instance){if(!d(this.options,f.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(f.instance.options)}`);return f.instance}f.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?b.FAILURE:this.done?b.SUCCESS:this.loading?b.LOADING:b.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let e=this.url;return e+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(e+="&key="+this.apiKey),this.channel&&(e+="&channel="+this.channel),this.client&&(e+="&client="+this.client),this.libraries.length>0&&(e+="&libraries="+this.libraries.join(",")),this.language&&(e+="&language="+this.language),this.region&&(e+="&region="+this.region),this.version&&(e+="&v="+this.version),this.mapIds&&(e+="&map_ids="+this.mapIds.join(",")),this.authReferrerPolicy&&(e+="&auth_referrer_policy="+this.authReferrerPolicy),e}deleteScript(){const e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,t)=>{this.loadCallback(r=>{r?t(r.error):e(window.google)})})}importLibrary(e){return this.execute(),google.maps.importLibrary(e)}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){var e,t;if(document.getElementById(this.id))return void this.callback();const r={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(r).forEach(e=>!r[e]&&delete r[e]),(null===(t=null===(e=null===window||void 0===window?void 0:window.google)||void 0===e?void 0:e.maps)||void 0===t?void 0:t.importLibrary)||(e=>{let t,r,i,s="The Google Maps JavaScript API",a="google",n="importLibrary",o="__ib__",l=document,u=window;u=u[a]||(u[a]={});const h=u.maps||(u.maps={}),d=new Set,p=new URLSearchParams,b=()=>t||(t=new Promise((n,u)=>c(this,void 0,void 0,(function*(){var c;for(i in yield r=l.createElement("script"),r.id=this.id,p.set("libraries",[...d]+""),e)p.set(i.replace(/[A-Z]/g,e=>"_"+e[0].toLowerCase()),e[i]);p.set("callback",a+".maps."+o),r.src=this.url+"?"+p,h[o]=n,r.onerror=()=>t=u(Error(s+" could not load.")),r.nonce=this.nonce||(null===(c=l.querySelector("script[nonce]"))||void 0===c?void 0:c.nonce)||"",l.head.append(r)}))));h[n]?console.warn(s+" only loads once. Ignoring:",e):h[n]=(e,...t)=>d.add(e)&&b().then(()=>h[n](e,...t))})(r);const i=this.libraries.map(e=>this.importLibrary(e));i.length||i.push(this.importLibrary("core")),Promise.all(i).then(()=>this.callback(),e=>{const t=new ErrorEvent("error",{error:e});this.loadErrorCallback(t)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){const e=this.errors.length*Math.pow(2,this.errors.length);console.error(`Failed to load Google Maps script, retrying in ${e} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},e)}else this.onerrorEvent=e,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version)return console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),void this.callback();this.loading=!0,this.setScript()}}}var g=r("b2c6"),m=r.n(g),v=r("1da8"),y=r.n(v),w=r("5307"),O=r.n(w),k=r("2ef0"),_=r.n(k),I=r("a2b6"),E=r("83a3"),j={__name:"MapView",props:{center:{type:Object},markers:{type:Array}},setup(e){const t=e,r=Object(E["a"])(),i=Object(a["ref"])(null),s=Object(a["toRef"])(t,"markers"),n=Object(a["toRef"])(t,"center");let o;console.log("center: ",Object(a["toRaw"])(n.value));const l=async()=>{const e=new f({apiKey:r.googleKey,version:"weekly",libraries:["places"]});o=await e.load(),c()};Object(a["watchEffect"])(()=>{t.center&&t.markers&&l()});const c=()=>{const e=new o.maps.Map(i.value,{zoom:3,minZoom:1,zoomControl:!0,center:_.a.isEmpty(Object(a["toRaw"])(n.value))?{lat:0,lng:0}:Object(a["toRaw"])(n.value),mapTypeId:o.maps.MapTypeId.ROADMAP});u(e)},u=e=>{s.value.forEach(t=>{const r=new o.maps.LatLng(t.position.lat,t.position.lng);let i="";i="ONLINE"===t.device_status?m.a:"TRACK"===t.device_status?O.a:y.a;const s={url:i,scaledSize:new o.maps.Size(23,30),origin:new o.maps.Point(0,0),anchor:new o.maps.Point(0,0)},a=new o.maps.Marker({position:r,map:e,icon:s,title:t.fullname,animation:o.maps.Animation.DROP});a.addListener("click",()=>{h(e,t,a)})})},h=(e,t,r)=>{const i=document.createElement("div");i.innerHTML=`\n      <div class="d-flex flex-column bg-surface-variant- mt-1">\n                <h6 class="text-body-1 text-medium-emphasis font-weight-bold">\n                  Name : ${t.fullname}\n                </h6>\n                <h6 class="text-body-2 text-medium-emphasis font-weight-bold">\n                  Phone : ${t.phone}\n                </h6>\n                <h6 class="text-body-2 text-medium-emphasis font-weight-bold">\n                  Email : ${t.email}\n                </h6>\n                <h6 class="text-body-2 text-medium-emphasis font-weight-bold">\n                  last location : ${d(t.updatedAt)}\n                </h6>\n              </div>\n  `;const s=new o.maps.InfoWindow({content:i});s.open(e,r)},d=e=>Object(I["a"])(e);return{__sfc:!0,App:r,props:t,mapDiv:i,markers:s,center:n,google:o,loadGoogleMaps:l,initMap:c,addMarkers:u,showInfoWindow:h,tripDate:d}}},S=j,C=r("2877"),x=Object(C["a"])(S,o,l,!1,null,"359c8ad2",null),L=x.exports,P=r("19cf"),R={data(){return{breadcrumbs:{title:"Eagle Eyes",b1:"Home",b2:"",b3:"",link:!1,name:"Eagle"}}},components:{MapView:L,Breadcrumb:P["a"]},setup(){let e=Object(a["ref"])(!1),t=Object(a["ref"])(!1),r=Object(a["ref"])(!1),i=Object(a["ref"])(!0),s=Object(a["ref"])({}),o=Object(a["ref"])(""),l=Object(a["ref"])([]),c=Object(a["ref"])("OFFLINE");const u=Object(a["ref"])(""),h=()=>{e.value=!0,navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{s.value={lat:t.coords.latitude,lng:t.coords.longitude},e.value=!1},t=>{o.value="Error retrieving location: "+t.message,e.value=!1}):(o="Geolocation is not supported by this browser.",e.value=!1)},d=async t=>{e.value=!0,c.value=t;const r=await n["o"].mapData(t,u.value);r.status&&(l.value=r.data,e.value=!1)};Object(a["onMounted"])(()=>{h(),d(c.value)}),Object(a["watch"])(u,e=>{d(c.value,e)},{deep:!0}),Object(a["watch"])(c,()=>p(),{deep:!0});const p=()=>{"ONLINE"===c.value?(i.value=!1,r.value=!1,t.value=!0):"TRACK"===c.value?(i.value=!1,r.value=!0,t.value=!1):"OFFLINE"===c.value&&(i.value=!0,r.value=!1,t.value=!1)};return{search:u,status:c,offlinepressed:i,trackpressed:r,onlinepressed:t,loading:e,center:s,centerError:o,markers:l,fetchMapData:d}}},M=R,A=(r("63e4"),Object(C["a"])(M,i,s,!1,null,"25ebf4c6",null));t["default"]=A.exports},"526f":function(e,t,r){},5307:function(e,t,r){e.exports=r.p+"img/bus_marker_track.43a7c921.png"},"63e4":function(e,t,r){"use strict";r("1739")},b2c6:function(e,t,r){e.exports=r.p+"img/bus_marker_green.de1810be.png"}}]);
//# sourceMappingURL=chunk-01115450.30de2834.js.map