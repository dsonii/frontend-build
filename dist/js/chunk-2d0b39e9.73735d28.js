(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b39e9"],{"28c0":function(t,e,o){"use strict";o.r(e);var r=function(){var t=this,e=t._self._c;return e("div",[e("section",{staticClass:"tables"},[e("div",{staticClass:"row"},[e("Breadcrumb",{attrs:{breadcrumbs:t.breadcrumbs}}),e("div",{staticClass:"col-lg-10 offset-lg-1 grid-margin stretch-card"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[e("h4",{staticClass:"card-title"},[t._v("Edit offer")]),e("b-form",{on:{submit:function(e){return e.preventDefault(),t.updateOffer.apply(null,arguments)}}},[e("b-form-group",{attrs:{label:"Offer name","label-for":"name-input","label-cols-sm":"4","label-cols-lg":"5","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-input",{class:{"is-invalid":t.submitted&&t.$v.form.name.$error},attrs:{id:"name-input",type:"text",placeholder:"Enter name",state:t.validateState("name")},model:{value:t.$v.form.name.$model,callback:function(e){t.$set(t.$v.form.name,"$model","string"===typeof e?e.trim():e)},expression:"$v.form.name.$model"}}),t.submitted&&!t.$v.form.name.required?e("div",{staticClass:"invalid-feedback"},[t._v(" offer name is required ")]):t._e()],1),e("b-form-group",{attrs:{label:"Start Date","label-for":"start-date-input","label-cols-sm":"4","label-cols-lg":"5","content-cols-sm":"","content-cols-lg":"7"}},[e("Datetime",{staticClass:"theme-ferri",attrs:{type:"date",title:"start date","input-class":"form-control",zone:"Asia/Kolkata","backdrop-click":!0},model:{value:t.form.start_date,callback:function(e){t.$set(t.form,"start_date",e)},expression:"form.start_date"}})],1),e("b-form-group",{attrs:{label:"End Date","label-for":"end-date-input","label-cols-sm":"4","label-cols-lg":"5","content-cols-sm":"","content-cols-lg":"7"}},[e("Datetime",{staticClass:"theme-ferri",attrs:{type:"date",title:"end date","input-class":"form-control",zone:"Asia/Kolkata","backdrop-click":!0},model:{value:t.form.end_date,callback:function(e){t.$set(t.form,"end_date",e)},expression:"form.end_date"}})],1),e("b-form-group",{attrs:{label:"Offer Code","label-for":"offer-code-input","label-cols-sm":"4","label-cols-lg":"5","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-input",{class:{"is-invalid":t.submitted&&t.$v.form.code.$error},attrs:{id:"chassis-no-input",type:"text",placeholder:"Enter offer code.",state:t.validateState("code"),formatter:t.formatter},model:{value:t.$v.form.code.$model,callback:function(e){t.$set(t.$v.form.code,"$model","string"===typeof e?e.trim():e)},expression:"$v.form.code.$model"}}),t.submitted&&!t.$v.form.code.required?e("div",{staticClass:"invalid-feedback"},[t._v(" offer code is required ")]):t._e()],1),e("b-form-group",{attrs:{label:"Discount (%)","label-for":"discount-input","label-cols-sm":"4","label-cols-lg":"5","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-input",{attrs:{id:"discount-input",type:"number",placeholder:"Enter discount %."},model:{value:t.form.discount,callback:function(e){t.$set(t.form,"discount","string"===typeof e?e.trim():e)},expression:"form.discount"}})],1),e("b-form-group",{attrs:{label:"No of attempt","label-for":"attempt-input","label-cols-sm":"4","label-cols-lg":"5","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-input",{attrs:{id:"attempt-input",type:"number",placeholder:"Enter no of attempt."},model:{value:t.form.attempt,callback:function(e){t.$set(t.form,"attempt","string"===typeof e?e.trim():e)},expression:"form.attempt"}})],1),e("b-form-group",{attrs:{label:"Offer picture (213x102)","label-for":"picture-input","label-cols-sm":"4","label-cols-lg":"5","content-cols-sm":"","content-cols-lg":"7"}},[t.form.picture?e("div",[e("img",{staticClass:"img-fluid",attrs:{src:t.form.picture,width:"213",height:"102"}}),e("button",{staticClass:"btn social-btn btn-rounded btn-danger mr-4",on:{click:function(e){return t.removeImage("picture")}}},[e("i",{staticClass:"mdi mdi-close"})])]):e("div",[e("b-form-file",{class:{"is-invalid":t.submitted&&t.$v.form.picture.$error},attrs:{id:"picture-input",accept:"image/jpeg, image/png, image/jpg",placeholder:"Choose a Offer picture or drop it here...",state:t.validateState("picture")},on:{change:function(e){return t.onFileChange(e,"picture")}}}),t.submitted&&!t.$v.form.picture.required?e("b-form-invalid-feedback",[t._v("picture is required")]):t._e()],1)]),e("b-form-group",{staticClass:"mt-3",attrs:{label:"type","label-for":"route-type-input","label-cols-sm":"4","label-cols-lg":"5","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-radio-group",{class:{"is-invalid":t.submitted&&t.$v.form.type.$error},attrs:{options:t.routeoptions,state:t.validateState("type")},on:{change:function(e){return t.changeRoute(e)}},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}}),t.submitted&&!t.$v.form.type.required?e("b-form-invalid-feedback",[t._v("Please select type")]):t._e()],1),t.route?e("b-form-group",{attrs:{label:"Route Name","label-for":"route-input","label-cols-sm":"4","label-cols-lg":"5","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-select",{attrs:{options:t.routes},scopedSlots:t._u([{key:"first",fn:function(){return[e("b-form-select-option",{attrs:{value:null,disabled:""}},[t._v("-- Please select an routes --")])]},proxy:!0}],null,!1,2000711963),model:{value:t.form.routeId,callback:function(e){t.$set(t.form,"routeId","string"===typeof e?e.trim():e)},expression:"form.routeId"}})],1):t._e(),e("b-form-group",{staticClass:"mt-3",attrs:{label:"Offer terms","label-for":"terms-input","invalid-feedback":"terms is required","label-cols-sm":"4","label-cols-lg":"3","content-cols-sm":"","content-cols-lg":"9"}},[e("vue-editor",{staticClass:"mt-3",class:{"is-invalid":t.submitted&&t.$v.form.terms.$error},attrs:{state:t.validateState("terms")},model:{value:t.form.terms,callback:function(e){t.$set(t.form,"terms",e)},expression:"form.terms"}})],1),e("b-form-group",{staticClass:"mt-3",attrs:{label:"Status ","label-for":"status-input","invalid-feedback":"status is required","label-cols-sm":"4","label-cols-lg":"3","content-cols-sm":"","content-cols-lg":"9"}},[e("b-form-radio-group",{attrs:{options:t.options,name:"status"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}}),t.submitted&&!t.$v.form.status.required?e("b-form-invalid-feedback",[t._v("Please select one")]):t._e()],1),e("b-form-group",{staticClass:"col-md-6 offset-md-5"},[e("b-button",{staticClass:"btn btn-lg btn-success text-center",attrs:{type:"submit"}},[t._v("Submit")])],1)],1)],1)])])],1)])])},s=[],a=(o("14d9"),o("0643"),o("fffc"),o("19cf")),l=o("dde5"),i=o("1dce"),n=o("b5ae"),c=o("859b"),m=(o("d355"),o("7f45")),d=o.n(m),u=o("5873"),f=o("be92"),p=o("370e"),b={name:"busedit",mixins:[i["validationMixin"]],data(){return{breadcrumbs:{title:"Edit offer",b1:"Manage offers",b2:"offer",b3:"Index",link:!0,name:"offers"},isEditing:!1,options:[{text:"Active",value:!0},{text:"Inactive",value:!1,default:!0}],routeoptions:[{text:"All",value:!0,default:!0},{text:"Specific route",value:!1}],form:{adminId:"",name:"",start_date:"",end_date:"",code:"",discount:"",attempt:"",routeId:"",picture:"",terms:"",status:"",type:""},submitted:!1,loading:!1,route:!1,routes:[]}},validations:{form:{name:{required:n["required"]},code:{required:n["required"]},picture:{required:n["required"]},type:{required:n["required"]},terms:{required:n["required"]},status:{required:n["required"]}}},computed:{...Object(f["e"])(p["a"],["getUser"])},components:{Breadcrumb:a["a"],Datetime:c["Datetime"],VueEditor:u["a"]},mounted(){""==this.form.start_date?d()().tz("Asia/Kolkata").format():this.form.start_date,""==this.form.end_date?d()().tz("Asia/Kolkata").add(7,"days").format():this.form.start_date,console.log("this.form.type ",this.form.type),0==this.form.type?this.route=!0:this.route=!1,this.loadRouteItems(),this.getoffer()},methods:{loadRouteItems(){l["y"].load().then(t=>{this.routes=t.data})},changeRoute(t){0==t?this.route=!0:(this.route=!1,this.form.routeId="")},onFileChange(t,e){var o=t.target.files||t.dataTransfer.files;console.log(o),o.length&&this.createImage(o[0],e)},createImage(t,e){var o=new FileReader,r=this;o.onload=t=>{r.form[e]=t.target.result},o.readAsDataURL(t)},removeImage:function(t){this.form[t]=""},formatter(t){return t.toUpperCase()},validateState(t){const{$dirty:e,$error:o}=this.$v.form[t];return e?!o:null},async getoffer(){try{const t=await l["q"].find(this.$route.params.id);t.status&&(this.form=t.data)}catch(t){console.log("params",t),this.$toast.open({message:t,type:"error",position:"top-right",duration:5e3})}},async updateOffer(){try{if(this.submitted=!0,this.$v.$touch(),this.$v.$invalid)return;this.form.adminId=this.getUser.id;const t=await l["q"].update(this.$route.params.id,this.form);t.status&&(this.$toast.open({message:t.message,type:"success",position:"top-right",duration:2e3}),setTimeout(()=>this.$router.push({path:"/offers"}),2e3))}catch(t){this.$toast.open({message:t,type:"error",position:"top-right",duration:5e3})}}}},g=b,v=o("2877"),h=Object(v["a"])(g,r,s,!1,null,"671a2ac9",null);e["default"]=h.exports}}]);
//# sourceMappingURL=chunk-2d0b39e9.73735d28.js.map