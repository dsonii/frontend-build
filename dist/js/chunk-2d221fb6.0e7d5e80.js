(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d221fb6"],{cd54:function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t._self._c;return e("div",[e("section",{staticClass:"tables"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-lg-12"},[e("Breadcrumb",{attrs:{breadcrumbs:t.breadcrumbs}})],1),e("div",{staticClass:"col-lg-8 offset-lg-2 grid-margin stretch-card"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[e("b-form",{on:{submit:function(e){return e.preventDefault(),t.updateCustomer.apply(null,arguments)}}},[e("b-form-group",{attrs:{label:"Company Name","label-for":"company-input","label-cols-sm":"4","label-cols-lg":"3","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-input",{class:{"is-invalid":t.submitted||t.$v.form.company.$error},attrs:{id:"company-input",type:"text",placeholder:"Enter company name",state:t.validateState("company")},model:{value:t.form.company,callback:function(e){t.$set(t.form,"company","string"===typeof e?e.trim():e)},expression:"form.company"}}),t.submitted||!t.$v.form.company.required?e("b-form-invalid-feedback",{staticClass:"invalid-feedback"},[t._v(" company name is required ")]):t._e()],1),e("b-form-group",{attrs:{label:"Customer Code","label-for":"customer-code-input","label-cols-sm":"4","label-cols-lg":"3","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-input",{class:{"is-invalid":t.submitted||t.$v.form.customer_code.$error},attrs:{id:"customer-code-input",type:"text",placeholder:"Enter customer code",state:t.validateState("customer_code")},model:{value:t.form.customer_code,callback:function(e){t.$set(t.form,"customer_code","string"===typeof e?e.trim():e)},expression:"form.customer_code"}}),t.submitted||!t.$v.form.customer_code.required?e("b-form-invalid-feedback",{staticClass:"invalid-feedback"},[t._v(" customer code name is required ")]):t._e()],1),e("b-form-group",{attrs:{label:"First name","label-for":"firstname-input","label-cols-sm":"4","label-cols-lg":"3","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-input",{attrs:{id:"firstname-input",type:"text",placeholder:"Enter first name"},model:{value:t.form.firstname,callback:function(e){t.$set(t.form,"firstname","string"===typeof e?e.trim():e)},expression:"form.firstname"}})],1),e("b-form-group",{attrs:{label:"Last name","label-for":"lastname-input","label-cols-sm":"4","label-cols-lg":"3","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-input",{attrs:{id:"lastname-input",type:"text",placeholder:"Enter last name"},model:{value:t.form.lastname,callback:function(e){t.$set(t.form,"lastname","string"===typeof e?e.trim():e)},expression:"form.lastname"}})],1),e("b-form-group",{attrs:{label:"Email Address","label-for":"email-input","label-cols-sm":"4","label-cols-lg":"3","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-input",{class:{"is-invalid":t.submitted&&t.$v.form.email.$error},attrs:{id:"email-input",type:"email",placeholder:"Enter email address",state:t.validateState("email")},model:{value:t.$v.form.email.$model,callback:function(e){t.$set(t.$v.form.email,"$model","string"===typeof e?e.trim():e)},expression:"$v.form.email.$model"}}),t.submitted&&!t.$v.form.email.required?e("div",{staticClass:"invalid-feedback"},[t._v(" email address is required ")]):t._e()],1),e("b-form-group",{attrs:{label:"Country code","label-for":"country-input","label-cols-sm":"4","label-cols-lg":"3","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-select",{class:{"is-invalid":t.submitted&&t.$v.form.country_code.$error},attrs:{options:t.countries,state:t.validateState("country_code")},scopedSlots:t._u([{key:"first",fn:function(){return[e("b-form-select-option",{staticClass:"text-sm",attrs:{value:null,disabled:""}},[t._v("-- Please select an country code --")])]},proxy:!0}]),model:{value:t.$v.form.country_code.$model,callback:function(e){t.$set(t.$v.form.country_code,"$model","string"===typeof e?e.trim():e)},expression:"$v.form.country_code.$model"}}),t.submitted||!t.$v.form.country_code.required?e("b-form-invalid-feedback",{staticClass:"invalid-feedback"},[t._v(" country code is required ")]):t._e()],1),e("b-form-group",{attrs:{label:"Phone Number","label-for":"phone-input","label-cols-sm":"4","label-cols-lg":"3","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-input",{class:{"is-invalid":t.submitted||t.$v.form.phone.$error},attrs:{id:"phone-input",placeholder:"Enter phone number"},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone","string"===typeof e?e.trim():e)},expression:"form.phone"}}),t.submitted||!t.$v.form.phone.required?e("b-form-invalid-feedback",{staticClass:"invalid-feedback"},[t._v(" mobile number is required ")]):t._e(),t.$v.form.phone.minLength?t._e():e("b-form-invalid-feedback",[t._v(" mobile number must have at least "+t._s(t.$v.form.phone.$params.minLength.min)+" letters. ")]),t.$v.form.phone.maxLength?t._e():e("b-form-invalid-feedback",[t._v(" mobile number must have at least "+t._s(t.$v.form.phone.$params.maxLength.max)+" letters. ")]),t.$v.form.phone.uniquePhone?t._e():e("b-form-invalid-feedback",[t._v(" Phone number already exists. ")])],1),e("b-form-group",{attrs:{label:"Time","label-for":"time-input","label-cols-sm":"4","label-cols-lg":"3","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-input",{class:{"is-invalid":t.submitted||t.$v.form.time_for_user.$error},attrs:{id:"time-input",type:"time",placeholder:"Enter time",state:t.validateState("time_for_user")},model:{value:t.$v.form.time_for_user.$model,callback:function(e){t.$set(t.$v.form.time_for_user,"$model","string"===typeof e?e.trim():e)},expression:"$v.form.time_for_user.$model"}}),t.submitted||!t.$v.form.time_for_user.required?e("b-form-invalid-feedback",{staticClass:"invalid-feedback"},[t._v(" Time is required ")]):t._e()],1),e("b-form-group",{staticClass:"mt-3",attrs:{label:"Status ","label-for":"status-input","invalid-feedback":"status is required","label-cols-sm":"4","label-cols-lg":"3","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-radio-group",{attrs:{options:t.options,name:"status"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showroute,expression:"showroute"}]},[e("b-form-group",{attrs:{label:"Pickup Location","label-for":"title-input","label-cols-sm":"4","label-cols-lg":"3","content-cols-sm":"","content-cols-lg":"7"}},[e("multiselect",{attrs:{options:t.locationOptions,placeholder:"Pickup Location",label:"title","track-by":"title",searchable:!0,loading:t.submitted},on:{"search-change":t.fetchLocations},scopedSlots:t._u([{key:"option",fn:function(e){return[t._v(" "+t._s(e.option.title)+" ")]}}]),model:{value:t.form.pickup_location[0].location,callback:function(e){t.$set(t.form.pickup_location[0],"location","string"===typeof e?e.trim():e)},expression:"form.pickup_location[0].location"}},[e("template",{slot:"noOptions"},[t._v(" No stop found.")]),e("template",{slot:"noResult"},[t._v(" stop searched not matched.")])],2)],1),e("b-form-group",{attrs:{label:"Drop Location","label-for":"title-input","label-cols-sm":"4","label-cols-lg":"3","content-cols-sm":"","content-cols-lg":"7"}},[e("multiselect",{attrs:{options:t.locationOptions,placeholder:"Drop Location",label:"title","track-by":"title",searchable:!0,loading:t.submitted},on:{"search-change":t.fetchLocations,select:t.onDropLocationSelect},scopedSlots:t._u([{key:"option",fn:function(e){return[t._v(" "+t._s(e.option.title)+" ")]}}]),model:{value:t.form.drop_location[0].location,callback:function(e){t.$set(t.form.drop_location[0],"location","string"===typeof e?e.trim():e)},expression:"form.drop_location[0].location"}},[e("template",{slot:"noOptions"},[t._v(" No stop found.")]),e("template",{slot:"noResult"},[t._v(" stop searched not matched.")])],2)],1),e("b-form-group",{attrs:{label:"Route","label-for":"route-input","label-cols-sm":"4","label-cols-lg":"3","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-select",{class:{"is-invalid":t.submitted&&t.$v.form.route.$error},attrs:{options:t.routeOption,state:t.validateState("route")},on:{change:t.getBuses},scopedSlots:t._u([{key:"first",fn:function(){return[e("b-form-select-option",{staticClass:"text-sm",attrs:{value:null,disabled:""}},[t._v("-- Please select an Route --")])]},proxy:!0}]),model:{value:t.$v.form.route.$model,callback:function(e){t.$set(t.$v.form.route,"$model","string"===typeof e?e.trim():e)},expression:"$v.form.route.$model"}})],1),e("b-form-group",{attrs:{label:"Vehicle","label-for":"bus-input","label-cols-sm":"4","label-cols-lg":"3","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-select",{class:{"is-invalid":t.submitted&&t.$v.form.bus.$error},attrs:{options:t.buses,state:t.validateState("bus")},on:{change:t.getAvaialbleSeats},scopedSlots:t._u([{key:"first",fn:function(){return[e("b-form-select-option",{staticClass:"text-sm",attrs:{value:null,disabled:""}},[t._v("-- Please select an Vehicle --")])]},proxy:!0}]),model:{value:t.$v.form.bus.$model,callback:function(e){t.$set(t.$v.form.bus,"$model","string"===typeof e?e.trim():e)},expression:"$v.form.bus.$model"}})],1),e("b-form-group",{attrs:{label:"Seat","label-for":"seat-input","label-cols-sm":"4","label-cols-lg":"3","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-select",{class:{"is-invalid":t.submitted&&t.$v.form.seat.$error},attrs:{options:t.seats,state:t.validateState("seat")},scopedSlots:t._u([{key:"first",fn:function(){return[e("b-form-select-option",{staticClass:"text-sm",attrs:{value:null,disabled:""}},[t._v("-- Please select an Seat --")])]},proxy:!0}]),model:{value:t.$v.form.seat.$model,callback:function(e){t.$set(t.$v.form.seat,"$model","string"===typeof e?e.trim():e)},expression:"$v.form.seat.$model"}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}]},[e("b-form-group",{attrs:{label:"Return Route","label-for":"returnroute-input","label-cols-sm":"4","label-cols-lg":"3","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-select",{class:{"is-invalid":t.submitted&&t.$v.form.return_route.$error},attrs:{options:t.return_routeOption,state:t.validateState("return_route")},on:{change:t.getReturnBuses},scopedSlots:t._u([{key:"first",fn:function(){return[e("b-form-select-option",{staticClass:"text-sm",attrs:{value:null,disabled:""}},[t._v("-- Please select an Route --")])]},proxy:!0}]),model:{value:t.$v.form.return_route.$model,callback:function(e){t.$set(t.$v.form.return_route,"$model","string"===typeof e?e.trim():e)},expression:"$v.form.return_route.$model"}})],1),e("b-form-group",{attrs:{label:"Return Vehicle","label-for":"returnbus-input","label-cols-sm":"4","label-cols-lg":"3","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-select",{class:{"is-invalid":t.submitted&&t.$v.form.return_bus.$error},attrs:{options:t.return_buses,state:t.validateState("return_bus")},on:{change:t.getReturnAvaialbleSeats},scopedSlots:t._u([{key:"first",fn:function(){return[e("b-form-select-option",{staticClass:"text-sm",attrs:{value:null,disabled:""}},[t._v("-- Please select an Vehicle --")])]},proxy:!0}]),model:{value:t.$v.form.return_bus.$model,callback:function(e){t.$set(t.$v.form.return_bus,"$model","string"===typeof e?e.trim():e)},expression:"$v.form.return_bus.$model"}})],1),e("b-form-group",{attrs:{label:"Return Seat","label-for":"returnseat-input","label-cols-sm":"4","label-cols-lg":"3","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-select",{class:{"is-invalid":t.submitted&&t.$v.form.return_seat.$error},attrs:{options:t.return_seats,state:t.validateState("return_seat")},scopedSlots:t._u([{key:"first",fn:function(){return[e("b-form-select-option",{staticClass:"text-sm",attrs:{value:null,disabled:""}},[t._v("-- Please select an Seat --")])]},proxy:!0}]),model:{value:t.$v.form.return_seat.$model,callback:function(e){t.$set(t.$v.form.return_seat,"$model","string"===typeof e?e.trim():e)},expression:"$v.form.return_seat.$model"}})],1)],1),e("b-form-group",{attrs:{label:"Is Return?","label-for":"return-input","label-cols-sm":"4","label-cols-lg":"3","content-cols-sm":"","content-cols-lg":"7"}},[e("b-form-checkbox",{attrs:{id:"checkbox-1",name:"checkbox-1",value:"1","unchecked-value":"0"},on:{change:function(e){return t.isReturn()}},model:{value:t.$v.form.has_return.$model,callback:function(e){t.$set(t.$v.form.has_return,"$model",e)},expression:"$v.form.has_return.$model"}})],1)],1),e("div",{staticClass:"d-flex justify-content-center"},[0==t.showroute?e("input",{staticClass:"btn btn-outline-primary mb-4",attrs:{name:"addpd",type:"button",value:"+ Create new default booking"},on:{click:t.addnewbooking}}):t._e(),1==t.showroute?e("input",{staticClass:"btn btn-outline-primary mb-4",attrs:{name:"addpd",type:"button",value:"+ Reset default booking"},on:{click:t.addnewbooking}}):t._e()]),e("b-form-group",{staticClass:"col-md-6 offset-md-4"},[e("b-button",{staticClass:"btn btn-lg btn-success text-center",attrs:{type:"submit"}},[e("span",{directives:[{name:"show",rawName:"v-show",value:t.submitted,expression:"submitted"}],staticClass:"pl-2 spinner-border spinner-border-sm"}),t._v("Update")])],1)],1)],1)])])])])])},r=[],a=(o("14d9"),o("0643"),o("fffc"),o("19cf")),l=o("1dce"),n=o("b5ae"),i=o("dde5"),u=o("2ef0"),c=o.n(u),m=o("8e5f"),d=o.n(m),f={name:"customeredit",mixins:[l["validationMixin"]],data(){return{show:!1,showroute:!1,breadcrumbs:{title:"Edit Customer",b1:"Manage customers",b2:"customer",b3:"Index",link:!0,name:"customer"},locationOptions:[],loading:!1,form:{id:"",company:"",customer_code:"",firstname:"",lastname:"",gender:"",country_code:"",phone:"",email:"",time_for_user:"",is_active:"",busScheduleId:"",refercode:"",pickup_location:[{location:[{}]}],drop_location:[{location:[{}]}],route:null,bus:null,seat:null,return_route:null,return_bus:null,return_seat:null,has_return:""},options:[{text:"Active",value:"true"},{text:"Inactive",value:"false",default:!0}],submitted:!1,countries:[],routeOption:[],return_routeOption:[],buses:[],return_buses:[],seats:[],return_seats:[],gender_options:[{text:"Male",value:"Male",default:"Male"},{text:"Female",value:"Female"}],isLoading:!1}},validations:{form:{company:{required:n["required"]},customer_code:{required:n["required"]},firstname:{required:n["required"]},lastname:{required:n["required"]},email:{required:n["required"],email:n["email"]},phone:{required:n["required"],numeric:n["numeric"],minLength:Object(n["minLength"])(10),maxLength:Object(n["maxLength"])(10),async uniquePhone(t){if(""===t)return!0;const{status:e}=await i["k"].isExists({phone:t,id:this.$route.params.id});return e}},country_code:{required:n["required"]},gender:{required:n["required"]},route:{},bus:{},seat:{},time_for_user:{},busScheduleId:{},refercode:{},has_return:{},return_route:{},return_bus:{},return_seat:{}}},components:{Breadcrumb:a["a"],Multiselect:d.a},mounted(){this.getcustomer(),this.loadCountries()},methods:{addnewbooking:function(){1==this.showroute?(this.showroute=!1,this.form.pickup_location[0].location="",this.form.drop_location[0].location="",this.route="",this.bus="",this.seat="",this.return_route="",this.return_bus="",this.return_seat="",this.show=!1):this.showroute=!0},isReturn:function(){1==this.form.has_return?(this.show=!0,this.searchReturnRoute()):this.show=!1},validateState(t){const{$dirty:e,$error:o}=this.$v.form[t];return e?!o:null},async loadCountries(){const t=await i["i"].load({search:""});this.countries=t.items},async getcustomer(){try{const t=await i["k"].find(this.$route.params.id);t.status&&(this.form.company=t.data.company,this.form.customer_code=t.data.customer_code,this.form.firstname=t.data.firstname,this.form.lastname=t.data.lastname,this.form.gender=t.data.gender,this.form.email=t.data.email,this.form.phone=t.data.phone,this.form.id=t.data.id,this.form.refercode=t.data.refercode,this.form.country_code=t.data.country_code,this.form.status=t.data.status)}catch(t){console.log("params",t),this.$toast.open({message:t,type:"error",position:"top-right",duration:5e3})}},fetchLocations(t,e){if(t.length){let o="PD";this.search(e,t,o,this)}},search:c.a.debounce(async(t,e,o,s)=>{try{const t=await i["n"].searchLocation({type:o,search:e});s.locationOptions=t.items}catch(r){(void 0).$toast.open({message:r,type:"error",position:"top-right",duration:5e3})}},350),searchReturnRoute(){i["y"].searchRoute({drop_lat:this.form.pickup_location[0].location.coordinates[1],drop_long:this.form.pickup_location[0].location.coordinates[0],pickup_lat:this.form.drop_location[0].location.coordinates[1],pickup_long:this.form.drop_location[0].location.coordinates[0]}).then(t=>{this.return_routeOption=t.data})},onDropLocationSelect(){i["y"].searchRoute({pickup_lat:this.form.pickup_location[0].location.coordinates[1],pickup_long:this.form.pickup_location[0].location.coordinates[0],drop_lat:this.form.drop_location[0].location.coordinates[1],drop_long:this.form.drop_location[0].location.coordinates[0]}).then(t=>{this.routeOption=t.data})},getBuses(){if(this.routeOption.length>0)for(let t=0;t<this.routeOption.length;t++)this.routeOption[t].value==this.form.route&&(this.buses=[{text:this.routeOption[t].bus_details.name,value:this.routeOption[t].route_busId}])},getReturnBuses(){if(this.return_routeOption.length>0)for(let t=0;t<this.return_routeOption.length;t++)this.return_routeOption[t].value==this.form.return_route&&(this.return_buses=[{text:this.return_routeOption[t].bus_details.name,value:this.return_routeOption[t].route_busId}])},getAvaialbleSeats(){let t="";if(this.routeOption.length>0)for(let e=0;e<this.routeOption.length;e++)this.routeOption[e].value==this.form.route&&(t=this.routeOption[e].busScheduleId,this.form.busScheduleId=this.routeOption[e].busScheduleId);i["g"].searchSeat(this.form.bus,t).then(t=>{this.seats=t.data})},getReturnAvaialbleSeats(){let t="";if(this.return_routeOption.length>0)for(let e=0;e<this.return_routeOption.length;e++)this.return_routeOption[e].value==this.form.return_route&&(t=this.return_routeOption[e].busScheduleId,this.form.return_busScheduleId=this.return_routeOption[e].busScheduleId);i["g"].searchSeat(this.form.bus,t).then(t=>{this.return_seats=t.data})},async updateCustomer(){try{if(this.submitted=!0,this.$v.$touch(),this.$v.$invalid)return;const t=await i["k"].update(this.$route.params.id,this.form);t.status&&(this.$toast.open({message:t.message,type:"success",position:"top-right",duration:2e3}),setTimeout(()=>this.$router.push({path:"/customers"}),2e3))}catch(t){this.$toast.open({message:t,type:"error",position:"top-right",duration:5e3})}}}},p=f,b=(o("1583"),o("2877")),h=Object(b["a"])(p,s,r,!1,null,"1bfef9bc",null);e["default"]=h.exports}}]);
//# sourceMappingURL=chunk-2d221fb6.0e7d5e80.js.map