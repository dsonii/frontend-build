(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-936fcad6"],{"64b3":function(e,t,a){},6953:function(e,t,a){"use strict";a("64b3")},"76d6":function(e,t,a){"use strict";a("d866")},a8d2:function(e,t,a){"use strict";a.r(t);a("0643"),a("76d6");var s=function(){var e=this,t=e._self._c;return t("section",{staticClass:"tables"},[t("b-form",{on:{submit:function(t){return t.preventDefault(),e.createTimeTable.apply(null,arguments)}}},[t("div",{staticClass:"row"},[t("Breadcrumb",{attrs:{breadcrumbs:e.breadcrumbs}}),t("div",{staticClass:"col-lg-10 offset-lg-1 grid-margin stretch-card"},[t("div",{staticClass:"card"},[t("div",{staticClass:"card-body"},[t("b-form-group",{attrs:{label:"Route Name","label-for":"route-input","label-cols-sm":"5","label-cols-lg":"4","content-cols-sm":"","content-cols-lg":"7"}},[t("multiselect",{class:{"is-invalid":e.submitted||e.$v.form.routeId.$error},attrs:{options:e.options,state:e.validateState("routeId"),placeholder:"start typing to search route name.",label:"text",value:"value","track-by":"text",searchable:!0,loading:e.submitted},on:{"search-change":e.fetchRoutes,input:e.changeRoutes,remove:e.removeRoute},scopedSlots:e._u([{key:"option",fn:function(t){return[e._v(" "+e._s(t.option.text)+" ")]}}]),model:{value:e.$v.form.routeId.$model,callback:function(t){e.$set(e.$v.form.routeId,"$model",t)},expression:"$v.form.routeId.$model"}},[t("template",{slot:"noOptions"},[e._v(" No route found.")]),t("template",{slot:"noResult"},[e._v(" Route searched not matched.")])],2),e.submitted||!e.$v.form.routeId.required?t("b-form-invalid-feedback",[e._v(" Route name is required ")]):e._e()],1),t("b-form-group",{attrs:{label:"Vehicle Types","label-for":"buse-types-input","label-cols-sm":"5","label-cols-lg":"4","content-cols-sm":"","content-cols-lg":"7"}},[t("b-form-select",{class:{"is-invalid":e.submitted&&e.$v.form.busId.$error},attrs:{state:e.validateState("busId"),options:e.routeoptions},scopedSlots:e._u([{key:"first",fn:function(){return[t("b-form-select-option",{attrs:{value:null,disabled:""}},[e._v("-- Please select an bus name --")])]},proxy:!0}]),model:{value:e.$v.form.busId.$model,callback:function(t){e.$set(e.$v.form.busId,"$model","string"===typeof t?t.trim():t)},expression:"$v.form.busId.$model"}}),e.submitted||!e.$v.form.busId.required?t("b-form-invalid-feedback",[e._v(" Vehicle name is required ")]):e._e()],1),e._l(e.form.stops,(function(a,s){return t("b-form-group",{key:s,attrs:{label:a.location_title,"label-for":"routes-input","label-cols-sm":"5","label-cols-lg":"4","content-cols-sm":"","content-cols-lg":"7"}},[0==s?t("b-form-group",{attrs:{label:"Departure Time:","label-for":"departure-time-input","label-cols-sm":"5","label-cols-lg":"5","content-cols-sm":"","content-cols-lg":"4"}},[t("Datetime",{staticClass:"theme-ferri",attrs:{type:"time",title:"Departure Time","input-class":"form-control",zone:e.timeZone},model:{value:a.departure_time,callback:function(t){e.$set(a,"departure_time",t)},expression:"data.departure_time"}})],1):s==e.form.stops.length-1?t("b-form-group",{attrs:{label:"Arrival Time:","label-for":"routes-input","label-cols-sm":"5","label-cols-lg":"5","content-cols-sm":"","content-cols-lg":"4"}},[t("Datetime",{staticClass:"theme-ferri",attrs:{type:"time",title:"Arrival Time","input-class":"form-control",zone:e.timeZone},model:{value:a.arrival_time,callback:function(t){e.$set(a,"arrival_time",t)},expression:"data.arrival_time"}})],1):t("div",[t("b-form-group",{attrs:{label:"Arrival Time:","label-for":"routes-input","label-cols-sm":"5","label-cols-lg":"5","content-cols-sm":"","content-cols-lg":"4"}},[t("Datetime",{staticClass:"theme-ferri",attrs:{type:"time",title:"Arrival Time","input-class":"form-control",zone:e.timeZone},model:{value:a.arrival_time,callback:function(t){e.$set(a,"arrival_time",t)},expression:"data.arrival_time"}})],1),t("b-form-group",{attrs:{label:"Departure Time :","label-for":"duration-input","label-cols-sm":"5","label-cols-lg":"5","content-cols-sm":"","content-cols-lg":"4"}},[t("Datetime",{staticClass:"theme-ferri",attrs:{type:"time",title:"Departure Time","input-class":"form-control",zone:e.timeZone},model:{value:a.departure_time,callback:function(t){e.$set(a,"departure_time",t)},expression:"data.departure_time"}})],1)],1)],1)})),t("b-form-group",{staticClass:"mt-3",attrs:{label:"Every ","label-for":"every-input","invalid-feedback":"Every is required","label-cols-sm":"5","label-cols-lg":"4","content-cols-sm":"","content-cols-lg":"8"}},[t("b-form-checkbox-group",{attrs:{id:"checkbox-group-1",options:e.everyoptions,state:e.validateState("every"),name:"every-1"},model:{value:e.$v.form.every.$model,callback:function(t){e.$set(e.$v.form.every,"$model","string"===typeof t?t.trim():t)},expression:"$v.form.every.$model"}}),t("b-form-invalid-feedback",{attrs:{state:e.validateState("every")}},[e._v("Please select every")])],1),t("b-form-group",{staticClass:"mt-3",attrs:{label:"Period operating ","label-for":"period-operating-input","invalid-feedback":"period operating is required","label-cols-sm":"5","label-cols-lg":"4","content-cols-sm":"","content-cols-lg":"8"}},[t("div",{staticClass:"row"},[t("datetime",{attrs:{"input-class":"form-control","min-datetime":e.form.start_date},model:{value:e.form.start_date,callback:function(t){e.$set(e.form,"start_date",t)},expression:"form.start_date"}}),e._v("  "),t("span",{},[e._v("To")]),e._v("   "),t("datetime",{attrs:{"input-class":"form-control","min-datetime":e.form.end_date},model:{value:e.form.end_date,callback:function(t){e.$set(e.form,"end_date",t)},expression:"form.end_date"}})],1)]),t("b-form-group",{staticClass:"mt-3",attrs:{label:"Status ","label-for":"status-input","invalid-feedback":"status is required","label-cols-sm":"5","label-cols-lg":"4","content-cols-sm":"","content-cols-lg":"7"}},[t("b-form-radio-group",{attrs:{options:e.statusOptions,name:"status",state:e.validateState("status")},model:{value:e.$v.form.status.$model,callback:function(t){e.$set(e.$v.form.status,"$model","string"===typeof t?t.trim():t)},expression:"$v.form.status.$model"}}),t("b-form-invalid-feedback",{attrs:{state:e.validateState("status")}},[e._v("Please select one")])],1),t("b-form-group",{staticClass:"col-md-6 offset-md-4"},[t("b-button",{staticClass:"btn btn-success btn-lg text-center mr-2",attrs:{type:"submit"}},[e._v("Create")]),t("b-button",{staticClass:"btn btn-default btn-lg text-center",attrs:{to:{name:"bus-schedules"}}},[e._v(" Back")])],1)],2)])])],1)])],1)},o=[],r=(a("14d9"),a("19cf")),l=a("dde5"),i=a("2ef0"),n=a.n(i),c=a("1dce"),u=a("b5ae"),d=a("859b"),m=(a("d355"),a("6632")),p=a("8e5f"),b=a.n(p),f=a("7f45"),v=a.n(f),h=a("83a3"),g=a("be92"),y={mixins:[c["validationMixin"]],name:"timetableCreate",components:{Breadcrumb:r["a"],Multiselect:b.a,Datetime:d["Datetime"]},data(){return{timeZone:Object(m["a"])().general.timezone,breadcrumbs:{title:"Create Vehicle Schedules",b1:"Manage Vehicle Schedules",b2:"Vehicle Schedules",b3:"Index",link:!0,name:"bus-schedules"},options:[],submitted:!1,routeoptions:[],form:{every:[],routeId:{},busId:"",stops:[],status:!0,departure_time:"",arrival_time:"",start_date:"",end_date:""},statusOptions:[{text:"Active",value:!0},{text:"Inactive",value:!1}],directionOptions:[{text:"Arriving",value:"arriving"},{text:"Departing",value:"departing"}],everyoptions:[{text:"Sunday",value:"sunday"},{text:"Monday",value:"monday"},{text:"Tuesday",value:"tuesday"},{text:"Wednesday",value:"wednesday"},{text:"Thursday",value:"thursday"},{text:"Friday",value:"friday"},{text:"Saturday",value:"saturday"}],directionName:"Arriving at",directionTitle:"Arriving at"}},validations:{form:{routeId:{required:u["required"]},busId:{required:u["required"]},every:{required:u["required"]},status:{required:u["required"]}}},mounted(){this.loadBusRoute(),this.form.start_date=v.a.tz(this.timezone).format("YYYY-MM-DD"),this.form.end_date=v.a.tz(this.timezone).add(1,"day").format("YYYY-MM-DD")},computed:{...Object(g["e"])(h["a"],["dateFormat","timezone"])},watch:{"form.stops":{handler:function(e){console.log("New age: ",e[0].departure_time),e[0]&&(this.form.departure_time=e[0].departure_time),e[e.length-1]&&(this.form.arrival_time=e[e.length-1].arrival_time)},deep:!0}},methods:{getDirection(e){this.directionName=e.charAt(0).toUpperCase()+e.slice(1)+" at",this.directionTitle=e.charAt(0).toUpperCase()+e.slice(1)+" at"},getRouteLocation(e){console.log("event",e)},loadBusRoute(){l["f"].loadBusByRoute().then(e=>{e.data.length>0?this.routeoptions=e.data:this.$toast.open({message:"No route found",type:"error",position:"top-right",duration:3e3})})},fetchRoutes(e,t){e.length&&this.search(t,e,this)},search:n.a.debounce(async(e,t,a)=>{try{const e=await l["y"].search(t);a.options=e.items}catch(s){console.log("err",s)}},350),async changeRoutes(e){try{const t=await l["y"].findStops(e.value);t&&t.status&&(this.form.stops=t.data)}catch(t){this.$toast.open({message:t.message,type:"error",position:"top-right",duration:5e3})}},async removeRoute(e,t){console.log("removedOption, id",e,t)},validateState(e){const{$dirty:t,$error:a}=this.$v.form[e];return t?!a:null},async createTimeTable(){try{if(this.submitted=!0,this.$v.$touch(),this.$v.$invalid)return;const e=await l["e"].create(this.form);e.status&&(this.submitted=!1,this.$toast.open({message:e.message,type:"success",position:"top-right",duration:2e3}),setTimeout(()=>this.$router.push({path:"/bus-schedules"}),2e3))}catch(e){this.$toast.open({message:e.message,type:"error",position:"top-right",duration:5e3})}}}},_=y,$=(a("6953"),a("1583"),a("2877")),x=Object($["a"])(_,s,o,!1,null,"8e3c913a",null);t["default"]=x.exports},d866:function(e,t,a){"use strict";var s=a("23e7"),o=a("2266"),r=a("59ed"),l=a("825a"),i=a("46c4");s({target:"Iterator",proto:!0,real:!0},{every:function(e){l(this),r(e);var t=i(this),a=0;return!o(t,(function(t,s){if(!e(t,a++))return s()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})}}]);
//# sourceMappingURL=chunk-936fcad6.ee523a9a.js.map